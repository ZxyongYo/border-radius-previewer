var u=Object.defineProperty;var m=(h,e,s)=>e in h?u(h,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):h[e]=s;var n=(h,e,s)=>(m(h,typeof e!="symbol"?e+"":e,s),s);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))i(t);new MutationObserver(t=>{for(const o of t)if(o.type==="childList")for(const d of o.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&i(d)}).observe(document,{childList:!0,subtree:!0});function s(t){const o={};return t.integrity&&(o.integrity=t.integrity),t.referrerpolicy&&(o.referrerPolicy=t.referrerpolicy),t.crossorigin==="use-credentials"?o.credentials="include":t.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(t){if(t.ep)return;t.ep=!0;const o=s(t);fetch(t.href,o)}})();class g{constructor({state:e={},boxEleId:s="box",shapeEleId:i="shape",codeEleId:t="code",widthInputId:o="width",heightInputId:d="height",resetBtnId:a="reset",copyBtnId:r="copy",messageEleId:l="message",moveableElems:c={}}={}){n(this,"state");n(this,"box");n(this,"shape");n(this,"codeEle");n(this,"widthInput");n(this,"heightInput");n(this,"resetBtn");n(this,"copyBtn");n(this,"messageEle");n(this,"timerId");this.box=document.getElementById(s),this.shape=document.getElementById(i),this.codeEle=document.getElementById(t),this.copyBtn=document.getElementById(r),this.messageEle=document.getElementById(l),this.widthInput=document.getElementById(o),this.heightInput=document.getElementById(d),this.resetBtn=document.getElementById(a),this.widthInput.addEventListener("change",()=>{this.updateState("width",this.widthInput.value),this.saveStateAsUrlHash()}),this.heightInput.addEventListener("change",()=>{this.updateState("height",this.heightInput.value),this.saveStateAsUrlHash()}),this.resetBtn.addEventListener("click",this.resetBoxSize.bind(this)),this.copyBtn.addEventListener("click",this.handleCopyCode.bind(this)),this.initState(e),this.initHandles(c)}updateState(e,s){this.state[e]=s,this.updateBorderRadius(),this.updateBoxSize()}updateBoxSize(){this.box.style.width=this.state.width+"px",this.box.style.height=this.state.height+"px",this.widthInput.value=this.state.width,this.heightInput.value=this.state.height}resetBoxSize(){this.box.removeAttribute("style"),this.state.width=this.box.offsetWidth.toFixed(0),this.state.height=this.box.offsetHeight.toFixed(0),this.widthInput.value=this.state.width,this.heightInput.value=this.state.height,this.saveStateAsUrlHash()}async handleCopyCode(){try{await this.setClipboard(this.codeEle.innerText),this.showMessage()}catch{this.showMessage("Not support!\u{1F494}")}}showMessage(e="Copied success! \u{1F44C}",s=2500){this.timerId&&clearTimeout(this.timerId),this.messageEle.innerText=e,this.messageEle.classList.add("visible"),this.timerId=setTimeout(()=>{this.messageEle.classList.remove("visible")},s)}setHash(e){window.history&&"pushState"in window.history?window.history.pushState(null,"",e):window.location.hash=e}setClipboard(e){return new Promise((s,i)=>{if(navigator.clipboard)navigator.clipboard.writeText(e).then(s).catch(i);else try{const t=document.createElement("textarea");t.value=e,t.readOnly=!0,document.body.appendChild(t),t.select(),t.setSelectionRange(0,e.length),document.execCommand("copy"),t.remove(),s(e)}catch(t){i(t)}})}static generateInitStateFromUrlHash(e){const s=/#(\d\d?|100)\.(\d\d?|100)\.(\d\d?|100)\.(\d\d?|100)-(?:(\d\d?|100)\.(\d\d?|100)\.(\d\d?|100)\.(\d\d?|100))?-(\d*).(\d*)/gm;if(!s.test(e))return;const i=["topX","rightY","bottomX","leftY","topY","rightX","bottomY","leftX","width","height"],t={};let o;for(s.lastIndex=0;(o=s.exec(e))!==null;)o.forEach((d,a)=>{a!=0&&d&&(t[i[a-1]]=d)});return t}}class f{constructor(e,s,i,t=30,o=()=>{}){n(this,"element");n(this,"onChange");n(this,"axis");n(this,"offset");n(this,"onDragEnd");n(this,"onMousedown",e=>{e.preventDefault(),this.element.classList.add("active"),document.addEventListener("mousemove",this.onMove,{passive:!0}),document.addEventListener("mouseup",this.onEnd),document.addEventListener("touchmove",this.onMove,{passive:!0}),document.addEventListener("touchend",this.onEnd)});n(this,"onMove",e=>{let s,i;e instanceof TouchEvent?(s=e.changedTouches[0].clientX,i=e.changedTouches[0].clientY):(s=e.clientX,i=e.clientY),this.setPosition(s,i),this.onChange(this.element.id,this.offset)});n(this,"onEnd",()=>{this.element.classList.remove("active"),this.onDragEnd(),document.removeEventListener("mousemove",this.onMove),document.removeEventListener("mouseup",this.onEnd),document.removeEventListener("touchmove",this.onMove),document.removeEventListener("touchend",this.onEnd)});this.element=e,this.onChange=s,this.axis=i,this.offset=t,this.onDragEnd=o,this.initPosition(t),this.onChange(this.element.id,this.offset),this.element.addEventListener("mousedown",this.onMousedown),this.element.addEventListener("touchstart",this.onMousedown)}setPosition(e,s){const i=this.element.parentElement.parentElement.getBoundingClientRect();if(this.axis==="x"){const t=+((e-i.left)/i.width*100).toFixed(0);this.offset=this.minmax(t,0,100),this.element.style.left=this.offset+"%"}else{const t=+((s-i.top)/i.height*100).toFixed(0);this.offset=this.minmax(t,0,100),this.element.style.top=this.offset+"%"}}initPosition(e){this.axis==="x"?this.element.style.left=e+"%":this.element.style.top=e+"%"}minmax(e,s,i){return Math.max(Math.min(e,i),s)}}export{g as A,f as M};
