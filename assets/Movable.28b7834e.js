var u=Object.defineProperty;var m=(h,t,s)=>t in h?u(h,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):h[t]=s;var i=(h,t,s)=>(m(h,typeof t!="symbol"?t+"":t,s),s);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))n(e);new MutationObserver(e=>{for(const o of e)if(o.type==="childList")for(const d of o.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&n(d)}).observe(document,{childList:!0,subtree:!0});function s(e){const o={};return e.integrity&&(o.integrity=e.integrity),e.referrerpolicy&&(o.referrerPolicy=e.referrerpolicy),e.crossorigin==="use-credentials"?o.credentials="include":e.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(e){if(e.ep)return;e.ep=!0;const o=s(e);fetch(e.href,o)}})();class g{constructor({state:t={},boxEleId:s="box",shapeEleId:n="shape",codeEleId:e="code",widthInputId:o="width",heightInputId:d="height",resetBtnId:a="reset",copyBtnId:r="copy",messageEleId:l="message",moveableElems:c={}}={}){i(this,"state");i(this,"box");i(this,"shape");i(this,"codeEle");i(this,"widthInput");i(this,"heightInput");i(this,"resetBtn");i(this,"copyBtn");i(this,"messageEle");i(this,"timerId");this.box=document.getElementById(s),this.shape=document.getElementById(n),this.codeEle=document.getElementById(e),this.copyBtn=document.getElementById(r),this.messageEle=document.getElementById(l),this.widthInput=document.getElementById(o),this.heightInput=document.getElementById(d),this.resetBtn=document.getElementById(a),this.widthInput.addEventListener("change",()=>{this.updateState("width",this.widthInput.value),this.saveStateAsUrlHash()}),this.heightInput.addEventListener("change",()=>{this.updateState("height",this.heightInput.value),this.saveStateAsUrlHash()}),this.resetBtn.addEventListener("click",this.resetBoxSize.bind(this)),this.copyBtn.addEventListener("click",this.handleCopyCode.bind(this)),this.initState(t),this.initHandles(c)}updateState(t,s){this.state[t]=s,this.updateBorderRadius(),this.updateBoxSize()}updateBoxSize(){this.box.style.width=this.state.width+"px",this.box.style.height=this.state.height+"px",this.widthInput.value=this.state.width,this.heightInput.value=this.state.height}resetBoxSize(){this.box.removeAttribute("style"),this.state.width=this.box.offsetWidth.toFixed(0),this.state.height=this.box.offsetHeight.toFixed(0),this.widthInput.value=this.state.width,this.heightInput.value=this.state.height,this.saveStateAsUrlHash()}async handleCopyCode(){try{await this.setClipboard(this.codeEle.innerText),this.showMessage()}catch{this.showMessage("Not support!\u{1F494}")}}showMessage(t="Copied success! \u{1F44C}",s=2500){this.timerId&&clearTimeout(this.timerId),this.messageEle.innerText=t,this.messageEle.classList.add("visible"),this.timerId=setTimeout(()=>{this.messageEle.classList.remove("visible")},s)}setHash(t){window.history&&"pushState"in window.history?window.history.pushState(null,"",t):window.location.hash=t}setClipboard(t){return new Promise((s,n)=>{if(navigator.clipboard)navigator.clipboard.writeText(t).then(s).catch(n);else try{const e=document.createElement("textarea");e.value=t,e.readOnly=!0,document.body.appendChild(e),e.select(),e.setSelectionRange(0,t.length),document.execCommand("copy"),e.remove(),s(t)}catch(e){n(e)}})}static generateInitStateFromUrlHash(t){const s=/#(\d\d?|100)\.(\d\d?|100)\.(\d\d?|100)\.(\d\d?|100)-(?:(\d\d?|100)\.(\d\d?|100)\.(\d\d?|100)\.(\d\d?|100))?-(\d*).(\d*)/gm;if(!s.test(t))return;const n=["topX","rightY","bottomX","leftY","topY","rightX","bottomY","leftX","width","height"],e={};let o;for(s.lastIndex=0;(o=s.exec(t))!==null;)o.forEach((d,a)=>{a!=0&&d&&(e[n[a-1]]=d)});return e}}class f{constructor(t,s,n,e=30,o=()=>{}){i(this,"element");i(this,"onChange");i(this,"axis");i(this,"offset");i(this,"onDragEnd");i(this,"onMousedown",t=>{t.preventDefault(),this.element.classList.add("active"),document.addEventListener("mousemove",this.onMove),document.addEventListener("mouseup",this.onEnd)});i(this,"onMove",t=>{this.setPosition(t.clientX,t.clientY),this.onChange(this.element.id,this.offset)});i(this,"onEnd",()=>{this.element.classList.remove("active"),this.onDragEnd(),document.removeEventListener("mousemove",this.onMove),document.removeEventListener("mouseup",this.onEnd)});this.element=t,this.onChange=s,this.axis=n,this.offset=e,this.onDragEnd=o,this.initPosition(e),this.onChange(this.element.id,this.offset),this.element.addEventListener("mousedown",this.onMousedown)}setPosition(t,s){const n=this.element.parentElement.parentElement.getBoundingClientRect();if(this.axis==="x"){const e=+((t-n.left)/n.width*100).toFixed(0);this.offset=this.minmax(e,0,100),this.element.style.left=this.offset+"%"}else{const e=+((s-n.top)/n.height*100).toFixed(0);this.offset=this.minmax(e,0,100),this.element.style.top=this.offset+"%"}}initPosition(t){this.axis==="x"?this.element.style.left=t+"%":this.element.style.top=t+"%"}minmax(t,s,n){return Math.max(Math.min(t,n),s)}}export{g as A,f as M};
